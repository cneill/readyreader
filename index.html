<!DOCTYPE html>
<html>
<head>
<title>Speedy</title>
<style>
body {
    background: #000;
}
.block {
    width: 100%;
    height: 200px;
    text-align: center;
    padding-top: 50px;
}
.first_half, .middle, .second_half {
    font-size: 50px;
    font-family: sans-serif;
    font-weight: bold;
}
.first_half, .second_half {
    color: #fff;
}
.middle {
    color: #f00;
}
#text_input, #go {
    display: block;
    margin-left: auto;
    margin-right: auto;
}
</style>
</head>
<body>
<div class="block">
    <div id="output"></div>
</div>
<textarea id="text_input" rows=20 cols=40></textarea>
<br />
<input id="go" type="submit" onClick="crunch_text();" value="GO!">
<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
<script>
var the_text = [];

var crunch_text = function() {
    tokenize($("#text_input").val());
    next(the_text.pop());
};

var next = function (word) {
    flip_word(word);
    time = Math.max(200, 40 * word.length);
    setTimeout(function () {
        if(the_text.length > 0) {
            next(the_text.pop());
        }
    }, time);
};

var flip_word = function (word) {
    var first_half, middle, second_half, html;

    if (word.length == 1) {
        middle = word;    
    } else if (word.length == 2) {
        middle = word[0];
        second_half = word[1];
    } else if (word.length == 3) {
        first_half = word[0];
        middle = word[1];
        second_half = word[2];
    } else {
        first_half = word.slice(0, Math.floor(word.length/2)-1);
        middle = word[Math.floor(word.length/2)-1];
        second_half = word.slice(Math.floor(word.length/2), word.length);
    }

    if (first_half) {
        html  = "<span class='first_half'>" + first_half + "</span>";
        html += "<span class='middle'>" + middle + "</span>";
        html += "<span class='second_half'>" + second_half + "</span>";
    } else {
        html = "<span class='middle'>" + middle + "</span>";
        html += (second_half ? "<span class='second_half'>" + second_half + "</span>" : "")
    }

    $("#output").html(html);
};

var tokenize = function (str) {
    str = str.replace(/\s+/, " ");
    str = str.replace(/\s$/, "");
    the_text = str.split(/\s+/).reverse();
};

</script>
</body>
</html>
